{% extends 'base.html.twig' %}

{% block extra_head %}
    <link rel="stylesheet" href="assets/css/docs.css">
    <link rel="stylesheet" href="assets/css/chapter-nav.css">
{% endblock %}

{% block body %}
    <!-- Main Content -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            {% if features.MenuBuilder.files[1] is defined %}
            <ul class="menu menu-1">
                {% for key, item in features.MenuBuilder.files[1] %}
                    {% if key == 'direct' %}
                        {# Direct menu items (menu = 1) #}
                        {% for directItem in item %}
                            <li class="menu-1"><a href="{{ directItem.url }}">{{ directItem.title }}</a></li>
                        {% endfor %}
                    {% elseif item.title is defined %}
                        {# This is a positioned item - check if it has numeric sub-keys (children) #}
                        {% set childItems = [] %}
                        {% for subKey, subItem in item %}
                            {% if subKey is iterable == false and subKey != 'title' and subKey != 'url' and subKey != 'file' and subKey != 'position' and subItem.title is defined %}
                                {% set childItems = childItems|merge([{key: subKey, item: subItem}]) %}
                            {% endif %}
                        {% endfor %}

                        {% if childItems|length > 0 %}
                            {# Parent item with children - show as expandable #}
                            <li class="menu-1-{{ key }} menu-parent">
                                <a href="{{ item.url }}">{{ item.title }}</a>
                                <ul class="menu-1-{{ key }}-submenu submenu">
                                    {% for child in childItems %}
                                        <li class="menu-1-{{ key }}-{{ child.key }}"><a href="{{ child.item.url }}">{{ child.item.title }}</a></li>
                                    {% endfor %}
                                </ul>
                            </li>
                        {% else %}
                            {# Regular menu item without children #}
                            <li class="menu-1-{{ key }}"><a href="{{ item.url }}">{{ item.title }}</a></li>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </ul>
            {% endif %}
        </aside>        <!-- Main Content -->
        <main class="content">
            {% if toc %}
                <div class="toc-mobile">
                    <div class="toc-title">On This Page</div>
                    {{ toc|raw }}
                </div>
            {% endif %}

            {% block content %}
                {{ content|raw }}
            {% endblock %}

            {# Chapter Navigation #}
            {% include '_chapter_nav.html.twig' %}
        </main>

        <!-- Right Sidebar (Table of Contents) -->
        <aside class="toc">
            {% if toc %}
                <div class="toc-title">On This Page</div>
                {{ toc|raw }}
            {% endif %}
        </aside>
    </div>
{% endblock %}
